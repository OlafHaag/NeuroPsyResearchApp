# screensgeneral.kv
#:kivy 1.11.1

<BaseScreen>
    color: app.theme_cls.bg_normal
    # Without canvas the transitions overlay the last screen.
    canvas:
        Color:
            rgba: root.color
        Rectangle:
            pos: self.pos
            size: self.size

<ScreenHome>:
    name: 'Home'
    on_leave: home_scroll.scroll_y = 1
    navbar_enabled: True

    MDBoxLayout:
        orientation: 'vertical'

        MDToolbar:
            title: _("MENU")
            elevation: 10
            left_action_items: [['menu', lambda instance: root.manager.sidebar.set_state()]]

        ScrollView:
            id: home_scroll
            do_scroll_x: False
            do_scroll_y: True
            scroll_type: ['bars', 'content']

            GridLayout:
                cols: 1
                padding: 10, 10

                MDLabel:
                    text: _('Welcome!')
                    markup: True
                    size_hint_y: None
                    font_style: 'H5'
                    padding: 10, 10
                    halign: 'center'

                MDLabel:
                    text: _('General Information')  # ToDo: General Information
                    markup: True
                    halign: 'justify'
                    size_hint_y: None
                    valign: 'top'

                MDSeparator:

                BoxLayout:
                    orientation: 'vertical'

                    MDLabel:
                        text: _("Available Studies")
                        font_style: 'H6'
                        halign: 'center'

                    TaskButton:
                        text: _("Circle Task")
                        task: 'Circle Task'
                        font_size: 24
                        pos_hint: {"center_x": .5, "center_y": .5}
                        on_release: root.manager.start_task(self.task)
                    Widget:  # Spacer.

<ScreenOutro>:
    name: 'Outro'
    navbar_enabled: True

    MDGridLayout:
        cols:1

        MDLabel:
            text: root.msg
            markup: True
            text_size: root.width, None
            size: self.texture_size
            halign: 'center'
            valign: 'middle'
        MDLabel:
            text: "[b]" + _("Personal Identifier:") + "[/b]\n" + app.settings.current_user
            markup: True
            text_size: root.width, None
            size: self.texture_size
            halign: 'center'
            valign: 'middle'

        BoxLayout:
            Widget:
            MDBoxLayout:
                orientation: 'vertical'
                spacing: 20
                padding: 10, 10

                AnchorLayout:
                    anchors: 'center', 'center'
                    MDRectangleFlatIconButton:
                        icon: 'upload'
                        text: _("Upload")
                        disabled: (not root.upload_btn_enabled) or (app.data_mgr.data_sent)
                        on_release: root.on_upload()
                AnchorLayout:
                    anchors: 'center', 'center'
                    MDRectangleFlatIconButton:
                        icon: 'email-send'
                        text: _("Send via E-Mail")
                        disabled: not app.settings.is_email_enabled
                        on_release: app.data_mgr.send_email(app.settings.email_recipient)
                AnchorLayout:
                    anchors: 'center', 'center'
                    MDRectangleFlatIconButton:
                        icon: 'home'
                        text: _("Home")
                        on_release:
                            app.settings.reset_current()
                            root.manager.go_home()
                AnchorLayout:
                    anchors: 'center', 'center'
                    MDRectangleFlatIconButton:
                        icon: 'close-box'
                        text: _("Exit")
                        on_release: root.manager.quit()
            Widget:
